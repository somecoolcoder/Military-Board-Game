:root{--size:48px}
    body{font-family:system-ui,Segoe UI,Roboto,Arial;margin:20px;background:#0b1220;color:#e6eef8}
    h1{font-size:18px;margin:0 0 10px}
    .controls{display:flex;gap:8px;align-items:center;margin-bottom:12px}
    .board{display:grid;grid-template-columns:repeat(var(--cols),var(--size));grid-template-rows:repeat(var(--cols),var(--size));gap:2px;background:#25303b;padding:6px;border-radius:8px;width:calc(var(--size)*var(--cols) + 16px)}
    .cell{width:var(--size);height:var(--size);display:flex;align-items:center;justify-content:center;font-weight:700;border-radius:4px;user-select:none;position:relative}
    .cell.dark{background:#11161b}
    .cell.light{background:#182025}
    .cell.highlight-yellow{outline:3px solid rgba(255,255,0,0.9);box-shadow:0 0 8px rgba(255,255,0,0.12) inset}
    .cell.highlight-red{outline:3px solid rgba(255,0,0,0.9);box-shadow:0 0 8px rgba(255,0,0,0.12) inset}
    .cell .redeploy-target::after {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      right: 2px;
      bottom: 2px;
      border-radius: 4px;
      box-shadow: 0 0 0 2px inset;
      opacity: 0.6;
    }
    .cell .redeploy-target.team-a::after { box-shadow: 0 0 0 2px rgba(60, 160, 255, 0.7) inset; }
    .cell .redeploy-target.team-b::after { box-shadow: 0 0 0 2px rgba(255, 77, 77, 0.7) inset; }
    .unit{width:38px;height:38px;border-radius:4px;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:10px;position:relative;z-index:1}
    .mil{background:linear-gradient(180deg,#3aa0ff,#005fb8);box-shadow:0 2px 6px rgba(0,0,0,0.6)}
    .sniper{background:linear-gradient(180deg,#ff5edb,#9b007a);box-shadow:0 2px 6px rgba(0,0,0,0.6)}
    .rifle{background:linear-gradient(180deg,#7effa6,#0f7f3b);box-shadow:0 2px 6px rgba(0,0,0,0.6)}
    .medic{background:linear-gradient(180deg,#ffd76b,#b87f00);box-shadow:0 2px 6px rgba(0,0,0,0.6)}
    .civ{background:linear-gradient(180deg,#bdbdbd,#7a7a7a);box-shadow:0 2px 6px rgba(0,0,0,0.6);color:#071018}
    .gren{background:linear-gradient(180deg,#ff9b5c,#b75b00);box-shadow:0 2px 6px rgba(0,0,0,0.6)}
    .general{background:linear-gradient(180deg,#ffd6f0,#b04fa0);box-shadow:0 2px 6px rgba(0,0,0,0.6)}
    .spy{background:linear-gradient(180deg,#d6fff2,#00a678);box-shadow:0 2px 6px rgba(0,0,0,0.6);color:#021}
    .commando{background:linear-gradient(180deg,#ff4d4d,#a60000);box-shadow:0 2px 6px rgba(0,0,0,0.6)}
    .marksman{background:linear-gradient(180deg,#4dd8ff,#0082a6);box-shadow:0 2px 6px rgba(0,0,0,0.6)}
    .corpse{background:linear-gradient(180deg,#555,#222);box-shadow:0 2px 6px rgba(0,0,0,0.8);color:#999;opacity:0.7}
    .wall{background:linear-gradient(180deg,#8b5a2b,#4a2e10);box-shadow:0 2px 6px rgba(0,0,0,0.6);color:#e6eef8}
    .hp-bar{height:4px;width:90%;background:#333;border-radius:6px;overflow:hidden;margin-top:3px}
    .hp{height:100%;background:#2dd36f;width:100%}
    .log{margin-top:12px;padding:8px;background:#071023;border-radius:6px;height:220px;overflow:auto;font-size:12px}
    .log .cover-text { color: #8fbc8f; font-style: italic; }
    button{background:#2b8bd6;border:0;padding:8px 10px;border-radius:6px;color:white;cursor:pointer}
    button:disabled{background:#555;cursor:wait;opacity:.7}
    .info{margin-left:8px;font-size:13px}
    .highlight{padding:6px;border-radius:6px;background:#0d2230;color:#e6eef8;border:1px solid #123}
    .statsBox{margin-top:10px;padding:8px;background:#071826;border-radius:8px}
    .statLine{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid rgba(255,255,255,0.03)}
    .small{font-size:12px;color:#aab}
    .cell.explosion {
      background-color: rgba(255, 100, 0, 0.4);
      box-shadow: 0 0 12px rgba(255, 100, 0, 0.5) inset;
    }
    .tide-container{position:relative;display:flex;width:100%;height:24px;background:#11161b;border-radius:6px;overflow:hidden;box-shadow:0 1px 4px rgba(0,0,0,0.4) inset;align-items:center;font-weight:bold;font-size:13px}
    .tide-bar{height:100%;transition:width .5s ease-in-out}
    .tide-a{background:linear-gradient(90deg,#3aa0ff,#005fb8)}
    .tide-b{background:linear-gradient(90deg,#ff4d4d,#a60000)}

    #animation-layer{position:absolute;top:6px;left:6px;width:calc(var(--size)*var(--cols) + (var(--cols) - 1)*2px);height:calc(var(--size)*var(--cols) + (var(--cols) - 1)*2px);pointer-events:none;z-index:10}
    .projectile{position:absolute;width:16px;height:4px;background:linear-gradient(90deg, #fff, #ffc300);border-radius:2px;box-shadow:0 0 6px #ffc300;transition:all .15s linear;transform-origin:center}
    .grenade-projectile {
      position: absolute;
      font-size: 24px;
      /* transition on left is linear, but top uses a bezier to simulate an arc */
      transition: left 0.4s linear, top 0.4s cubic-bezier(0.3, -0.7, 0.7, 1), transform 0.4s ease-out;
      transform-origin: center;
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }
    .death-puff{position:absolute;width:var(--size);height:var(--size);display:flex;align-items:center;justify-content:center;font-size:24px;animation:death-animation .4s ease-out forwards}
    @keyframes death-animation{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(1.5)}}
    .heal-effect{position:absolute;width:var(--size);height:var(--size);display:flex;align-items:center;justify-content:center;font-size:24px;color:#2dd36f;text-shadow:0 0 5px #2dd36f;animation:effect-animation .5s ease-out forwards}
    .bandage-effect{position:absolute;width:var(--size);height:var(--size);display:flex;align-items:center;justify-content:center;font-size:20px;animation:effect-animation .5s ease-out forwards}
    @keyframes effect-animation{0%{opacity:1;transform:.8)}100%{opacity:0;transform:scale(1.2)}}
    .damage-flash{position:absolute;width:var(--size);height:var(--size);border-radius:4px;background:rgba(255,50,50,0.5);animation:flash-animation .4s ease-out forwards}
    @keyframes flash-animation{0%{opacity:1;transform:scale(1.1)}100%{opacity:0;transform:scale(1)}}
    #aiChatInput { background: #11161b; border: 1px solid #25303b; color: white; padding: 6px; border-radius: 4px; flex-grow: 1; }
    #aiChatInput::placeholder { color: #889; }
    #aiChatHistory .user-message { color: #aef; text-align: right; margin-left: 20%; }
    #aiChatHistory .ai-message { color: #8f8; white-space: pre-wrap; margin-right: 20%; }
    #aiChatHistory .ai-message strong { color: #fff; }
    #aiChatHistory .error-message { color: #f88; }
    #aiScenarioInput { background: #11161b; border: 1px solid #25303b; color: white; padding: 6px; border-radius: 4px; resize: vertical; font-family: inherit; font-size: 13px; }
    #aiScenarioInput::placeholder { color: #889; }